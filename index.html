<!DOCTYPE html>
<html lang="es" dir="ltr">
  <head>
    <meta charset="utf-8">
    <title></title>
    <link rel="stylesheet" href="css/estilos.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>
</head>
  <body>
<nav class="navbar navbar-light bg-secondary text-white">
    <a class="navbar-brand" href="#">FORMULARIO</a>
  </nav>
  <nav class="navbar navbar-light bg-primary">
    <span class="navbar-brand mb-0 h1">MERCEDES GOMEZ</span>
  </nav>
  <!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Formulario</title>
  <style>
    body {
      font-family: Arial, sans-serif;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 20px;
    }
    th, td {
      border: 1px solid #ddd;
      padding: 8px;
      text-align: left;
    }
    th {
      background-color: #f2f2f2;
    }
  </style>
</head>
<body>

  <h2 >ALIMENTOS SALUDABLES</h2>
  <form  id="alimentoForm">
    <label for="nombre">Nombre:</label>
    <input type="text" id="nombre" required>
    <br></br>
    <label for="tipo">Tipo:</label>
    <input type="text" id="tipo" required>
    <br></br>
    <label for="nutricion">Contenido Nutricional:</label>
    <input type="text" id="nutricion" required>
    <br></br>
    <label for="nutricion">Preparacion:</label>
    <input type="text" id="preparacion" required>
    <br></br>
    <label for="nutricion">Fuente:</label>
    <input type="text" id="fuente" required>


    <br></br>
    <button type="button" onclick="crearActualizarAlimento()">Guardar</button>
  </form>

  <table id="tablaAlimentos">
    <tr>
      <th>Nombre</th>
      <th>Tipo</th>
      <th>Contenido Nutricional</th>
      <th>Preparacion</th>
      <th>Fuente</th>
      <th>Acciones</th>
    </tr>
  </table>

  
  <script type="module">
    // Import the functions you need from the SDKs you need
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.0/firebase-app.js";
    import { getDatabase, ref, set, push, update, onValue, remove } from "https://www.gstatic.com/firebasejs/10.7.0/firebase-database.js";
    // TODO: Add SDKs for Firebase products that you want to use
    // https://firebase.google.com/docs/web/setup#available-libraries
  
    // Your web app's Firebase configuration
    // For Firebase JS SDK v7.20.0 and later, measurementId is optional
    const firebaseConfig = {
      apiKey: "AIzaSyDwwOLfQqPfQjXHo9CKlAFAglnMcZ4nAWI",
      authDomain: "evaluacion-583c8.firebaseapp.com",
      projectId: "evaluacion-583c8",
      storageBucket: "evaluacion-583c8.appspot.com",
      messagingSenderId: "1019978794039",
      appId: "1:1019978794039:web:d8983bb4ed5de3e2b16bb2",
      measurementId: "G-P7M6GSTQBS"
    };

    const app = initializeApp(firebaseConfig);
    const database = getDatabase(app);

    window.crearActualizarAlimento = function () {
        const nombre = document.getElementById("nombre").value;
        const tipo = document.getElementById("tipo").value;
        const nutricion = document.getElementById("nutricion").value;
        const preparacion = document.getElementById("preparacion").value;
        const fuente = document.getElementById("fuente").value;

        const alimentoData = {
            nombre: nombre,
            tipo: tipo,
            nutricion: nutricion,
            preparacion: preparacion,
            fuente: fuente
        };

        push(ref(database, 'Mercedes_Gomez'), alimentoData);
    }

    
     // Función para cargar datos al formulario al editar
 window.editarRegistro = function(key) {
    const registroRef = ref(database, Roberth_Torres/${key});

    // Obtener los datos del registro seleccionado
    onValue(registroRef, (snapshot) => {
      const registro = snapshot.val();

      // Llenar el formulario con los datos del registro
      document.getElementById("nombre").value = registro.nombre;
      document.getElementById("apellido").value = registro.apellido;
      document.getElementById("email").value = registro.email;
      document.getElementById("direccion").value = registro.direccion;
      document.getElementById("celular").value = registro.celular;

      // Cambiar el texto del botón a "Actualizar"
      document.getElementById("editarButton").innerText = "Actualizar";

      // Agregar la clave del registro al botón de editar para indicar que es una edición
      document.getElementById("editarButton").setAttribute("onclick", guardarRegistro('${key}'));
    });
  };

  // Función para guardar (actualizar) un registro
  window.guardarRegistro = function(key) {
    const nombre = document.getElementById("nombre").value;
    const apellido = document.getElementById("apellido").value;
    const email = document.getElementById("email").value;
    const direccion = document.getElementById("direccion").value;
    const celular = document.getElementById("celular").value;

    // Verificar si es una edición o un nuevo registro
    if (key) {
      // Actualizar el registro en la base de datos
      const registroRef = ref(database, Roberth_Torres/${key});
      set(registroRef, {
        nombre: nombre,
        apellido: apellido,
        email: email,
        direccion: direccion,
        celular: celular
      });

      // Restaurar el botón de "Enviar" después de actualizar
      document.getElementById("guardarButton").style.display = "block";
    } else {
      // Agregar un nuevo registro a la base de datos
      push(ref(database, 'Mercedes_Gomez'), {
        nombre: nombre,
        apellido: apellido,
        email: email,
        direccion: direccion,
        celular: celular
      });
    }

    // Limpiar el formulario después de actualizar o agregar
    document.getElementById("nombre").value = "";
    document.getElementById("apellido").value = "";
    document.getElementById("email").value = "";
    document.getElementById("direccion").value = "";
    document.getElementById("celular").value = "";

    // Ocultar el botón de "Actualizar"
    document.getElementById("editarButton").style.display = "none";
  };



    window.eliminarAlimento = function (key) {
       
        remove(ref(database, 'Mercedes_Gomez/' + key));
    }

    
    onValue(ref(database, 'Mercedes_Gomez'), (snapshot) => {
        const alimentos = snapshot.val();
        const tablaAlimentos = document.getElementById('tablaAlimentos').getElementsByTagName('tbody')[0];

        
        tablaAlimentos.innerHTML = "";

        // Agrega filas con datos de alimentos a la tabla
        for (const key in alimentos) {
            if (alimentos.hasOwnProperty(key)) {
                const alimento = alimentos[key];
                const fila = `
                    <tr>
                        <td>${alimento.nombre}</td>
                        <td>${alimento.tipo}</td>
                        <td>${alimento.nutricion}</td>
                        <td>${alimento.preparacion}</td>
                        <td>${alimento.fuente}</td>
                        <td>
                            <button type="button" class="btn btn-warning" onclick="editarAlimento('${key}')">Editar</button>
                            <button type="button" class="btn btn-danger" onclick="eliminarAlimento('${key}')">Eliminar</button>
                        </td>
                    </tr>
                `;
                tablaAlimentos.innerHTML += fila;
            }
        }
    });
</script>
  
</body>
</html>